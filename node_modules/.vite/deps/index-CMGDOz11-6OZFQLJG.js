import "./chunk-CT72YLBL.js";
import {
  isInCodeBlock,
  isInList
} from "./chunk-M2IBMVYD.js";
import "./chunk-NU6SAH36.js";
import {
  Decoration,
  DecorationSet,
  Plugin,
  PluginKey,
  findParent,
  h,
  ue
} from "./chunk-GFK4PW34.js";
import "./chunk-AP6IPAVY.js";
import "./chunk-DP4XHQAG.js";

// node_modules/@milkdown/crepe/lib/esm/index-CMGDOz11.js
function isDocEmpty(doc) {
  var _a;
  return doc.childCount <= 1 && !((_a = doc.firstChild) == null ? void 0 : _a.content.size);
}
function createPlaceholderDecoration(state, placeholderText) {
  const { selection } = state;
  if (!selection.empty)
    return null;
  const $pos = selection.$anchor;
  const node = $pos.parent;
  if (node.content.size > 0)
    return null;
  const inTable = findParent((node2) => node2.type.name === "table")($pos);
  if (inTable)
    return null;
  const before = $pos.before();
  return Decoration.node(before, before + node.nodeSize, {
    "class": "crepe-placeholder",
    "data-placeholder": placeholderText
  });
}
var placeholderConfig = h({
  text: "Please enter...",
  mode: "block"
}, "placeholderConfigCtx");
var placeholderPlugin = ue((ctx) => {
  return new Plugin({
    key: new PluginKey("CREPE_PLACEHOLDER"),
    props: {
      decorations: (state) => {
        var _a;
        const config = ctx.get(placeholderConfig.key);
        if (config.mode === "doc" && !isDocEmpty(state.doc))
          return null;
        if (isInCodeBlock(state.selection) || isInList(state.selection))
          return null;
        const placeholderText = (_a = config.text) != null ? _a : "Please enter...";
        const deco = createPlaceholderDecoration(state, placeholderText);
        if (!deco)
          return null;
        return DecorationSet.create(state.doc, [deco]);
      }
    }
  });
});
var defineFeature = (editor, config) => {
  editor.config((ctx) => {
    if (config) {
      ctx.update(placeholderConfig.key, (prev) => {
        return {
          ...prev,
          ...config
        };
      });
    }
  }).use(placeholderPlugin).use(placeholderConfig);
};
export {
  defineFeature,
  placeholderConfig,
  placeholderPlugin
};
//# sourceMappingURL=index-CMGDOz11-6OZFQLJG.js.map
